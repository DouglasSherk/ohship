$(document).ready ->
  presignup = $('.presignup')
  presignup.submit (e) ->
    btn = $('.presignup button')
    icon = btn.find('i')
    if icon.hasClass 'fa-check'
      return false
    icon.removeClass 'fa-envelope'
    icon.addClass 'fa-spin fa-spinner'
    $.ajax presignup.attr('action') + '.json',
      type: 'POST',
      data: presignup.serialize(),
      dataType: 'text',
      success: (data) ->
        icon.removeClass 'fa-spin fa-spinner fa-times'
        icon.addClass 'fa-check'
        btn.removeClass 'btn-primary'
        btn.addClass 'btn-success'
      error: (data, error) ->
        icon.removeClass 'fa-spin fa-spinner'
        icon.addClass 'fa-times'
        btn.removeClass 'btn-primary'
        btn.addClass 'btn-danger'
    false
